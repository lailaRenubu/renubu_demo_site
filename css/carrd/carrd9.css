<style>
/* ========================= IMPROVED ALIGNMENT SYSTEM ========================= */
/* ========================= STEP 1 CONNECTIONS ========================= */
/* B3: Large center dot where horizontal lines converge (Step 1) */
#workflow-embed .step-1::before {
    content: '';
    position: absolute;
    top: calc(var(--step-height) * 0.54);
    left: var(--center-line);
    transform: translateX(-50%);
    width: var(--connection-dot-size);
    height: var(--connection-dot-size);
    background: var(--workflow-accent);
    border-radius: 50%;
    z-index: 15;
}

/* C1: Vertical line from center dot to R processor (Step 1) */
#workflow-embed .step-1::after {
    content: '';
    position: absolute;
    top: calc(var(--step-height) * 0.66 + var(--connection-dot-size) / 2);
    left: var(--center-line);
    transform: translateX(-50%);
    width: var(--connection-line-width);
    height: calc(var(--step-height) * 0.34 - var(--connection-dot-size) / 2 + 4rem);
    background-image: repeating-linear-gradient(0deg, var(--workflow-accent) 0px, var(--workflow-accent) 12px, transparent 12px, transparent 24px);
    animation: moveVerticalContinuous 2s linear infinite, flickerOnly 1s ease-in-out infinite;
    border-radius: 3px;
    z-index: 10;
}

/* ========================= STEP 3 CONNECTIONS ========================= */
/* F1: Large center dot where horizontal lines converge (Step 3) */
#workflow-embed .step-3::before {
    content: '';
    position: absolute;
    bottom: calc(var(--step-height) * 0.33);
    left: var(--center-line);
    transform: translateX(-50%);
    width: var(--connection-dot-size);
    height: var(--connection-dot-size);
    background: var(--workflow-accent);
    border-radius: 50%;
    z-index: 15;
}

/* D1: Vertical line from center dot to R processor (Step 3) */
#workflow-embed .step-3::after {
    content: '';
    position: absolute;
    bottom: calc(2.5vh - 0.75rem);
    left: var(--center-line);
    transform: translateX(-50%);
    width: var(--connection-line-width);
    height: calc(var(--step-height) * 0.33 - var(--connection-dot-size) / 2);
    background-image: repeating-linear-gradient(0deg, var(--workflow-accent) 0px, var(--workflow-accent) 12px, transparent 12px, transparent 24px);
    animation: moveVerticalContinuous 2s linear infinite, flickerOnly 1s ease-in-out infinite;
    border-radius: 3px;
    z-index: 10;
}

/* ========================= HORIZONTAL CONNECTIONS ========================= */
/* Right horizontal line converging to center dot (Step 1) */
#workflow-embed .intel-sources::before {
    content: '';
    position: absolute;
    bottom: calc(-1 * (var(--step-height) * 0.66 - var(--step-height) * 0.5));
    right: 12.5%;
    width: 37.5%;
    height: var(--horizontal-line-width);
    background-image: repeating-linear-gradient(90deg, var(--workflow-accent) 0px, var(--workflow-accent) 8px, transparent 8px, transparent 16px);
    animation: moveHorizontalRight 2s linear infinite;
    border-radius: 2px;
    z-index: 5;
    transform: translateY(-50%);
}

/* Left horizontal line converging to center dot (Step 1) */
#workflow-embed .intel-sources::after {
    content: '';
    position: absolute;
    bottom: calc(-1 * (var(--step-height) * 0.66 - var(--step-height) * 0.5));
    left: 12.5%;
    width: 37.5%;
    height: var(--horizontal-line-width);
    background-image: repeating-linear-gradient(90deg, var(--workflow-accent) 0px, var(--workflow-accent) 8px, transparent 8px, transparent 16px);
    animation: moveHorizontalLeft 2s linear infinite;
    border-radius: 2px;
    z-index: 5;
    transform: translateY(-50%);
}

/* ========================= INTEL SOURCE VERTICAL CONNECTIONS ========================= */
/* Vertical lines from intel sources down to connection points */
#workflow-embed .intel-source::after {
    content: '';
    position: absolute;
    top: 100%;
    left: var(--center-line);
    transform: translateX(-50%);
    width: var(--horizontal-line-width);
    height: calc(var(--step-height) * 0.18);
    background: repeating-linear-gradient(0deg, var(--workflow-processor) 0px, var(--workflow-processor) 8px, transparent 8px, transparent 16px);
    animation: moveVertical 2s linear infinite;
    border-radius: 2px;
}

/* Dots at the end of vertical lines from intel sources */
#workflow-embed .intel-source::before {
    content: '';
    position: absolute;
    top: calc(100% + var(--step-height) * 0.18);
    left: var(--center-line);
    transform: translateX(-50%);
    width: 1rem;
    height: 1rem;
    background: var(--workflow-processor);
    border-radius: 50%;
    z-index: 10;
}

/* ========================= STEP 2 & 4 BIDIRECTIONAL CONNECTIONS ========================= */
/* Bidirectional vertical lines from R processor to center dots in Step 2/4 */
#workflow-embed .step-2 .analysis-split::before,
#workflow-embed .step-4 .analysis-split::before {
    content: '';
    position: absolute;
    bottom: 60%;
    left: var(--center-line);
    transform: translateX(-50%);
    width: 9px;
    height: calc(var(--step-height) * 0.33);
    background-size: 2.5px 100%, 2.5px 100%;
    background-position: 0 0, 6.5px 0;
    background-repeat: no-repeat;
    animation: moveVerticalBidirectionalSmooth 2s linear infinite, flickerOnly 1s ease-in-out infinite;
    border-radius: 2px;
    z-index: 10;
}

#workflow-embed .step-2 .analysis-split::before {
    background-image: repeating-linear-gradient(0deg, var(--workflow-step-2) 0px, var(--workflow-step-2) 8px, transparent 8px, transparent 16px), repeating-linear-gradient(0deg, var(--workflow-step-2) 0px, var(--workflow-step-2) 8px, transparent 8px, transparent 16px);
}

#workflow-embed .step-4 .analysis-split::before {
    background-image: repeating-linear-gradient(0deg, var(--workflow-step-4) 0px, var(--workflow-step-4) 8px, transparent 8px, transparent 16px), repeating-linear-gradient(0deg, var(--workflow-step-4) 0px, var(--workflow-step-4) 8px, transparent 8px, transparent 16px);
}

/* Center dots for analysis split sections */
#workflow-embed .step-2 .analysis-split::after,
#workflow-embed .step-4 .analysis-split::after {
    content: '';
    position: absolute;
    bottom: 33%;
    left: var(--center-line);
    transform: translate(-50%, -50%);
    width: var(--connection-dot-size);
    height: var(--connection-dot-size);
    border-radius: 50%;
    z-index: 15;
}

#workflow-embed .step-2 .analysis-split::after {
    background: var(--workflow-step-2);
}

#workflow-embed .step-4 .analysis-split::after {
    background: var(--workflow-step-4);
}

/* ========================= ANALYSIS BOX HORIZONTAL CONNECTIONS ========================= */
/* Left analysis box horizontal connection */
#workflow-embed .analysis-box:first-child .analysis-box-content::before {
    content: '';
    position: absolute;
    top: 50%;
    left: calc(100% + 2px);
    transform: translateY(-50%);
    width: calc(var(--grid-width) * 0.12);
    height: var(--horizontal-line-width);
    border-radius: 2px;
    z-index: 5;
}

#workflow-embed .step-2 .analysis-box:first-child .analysis-box-content::before {
    background-image: repeating-linear-gradient(90deg, var(--workflow-step-2) 0px, var(--workflow-step-2) 8px, transparent 8px, transparent 16px);
    animation: moveHorizontalRight 2s linear infinite;
}

#workflow-embed .step-4 .analysis-box:first-child .analysis-box-content::before {
    background-image: repeating-linear-gradient(90deg, var(--workflow-step-4) 0px, var(--workflow-step-4) 8px, transparent 8px, transparent 16px);
    animation: moveHorizontalRight 2s linear infinite;
}

/* Right analysis box horizontal connection */
#workflow-embed .analysis-box:last-child .analysis-box-content::before {
    content: '';
    position: absolute;
    top: 50%;
    right: calc(100% + 2px);
    transform: translateY(-50%);
    width: calc(var(--grid-width) * 0.12);
    height: var(--horizontal-line-width);
    border-radius: 2px;
    z-index: 5;
}

#workflow-embed .step-2 .analysis-box:last-child .analysis-box-content::before {
    background-image: repeating-linear-gradient(90deg, var(--workflow-step-2) 0px, var(--workflow-step-2) 8px, transparent 8px, transparent 16px);
    animation: moveHorizontalLeft 2s linear infinite;
}

#workflow-embed .step-4 .analysis-box:last-child .analysis-box-content::before {
    background-image: repeating-linear-gradient(90deg, var(--workflow-step-4) 0px, var(--workflow-step-4) 8px, transparent 8px, transparent 16px);
    animation: moveHorizontalLeft 2s linear infinite;
}
</style>